<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/spark/styles.8593ab42798bf94635b6.css">@import url(https://fonts.googleapis.com/css?family=Inconsolata&display=swap);@import url(https://fonts.googleapis.com/css?family=Source+Sans+Pro&display=swap);html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em georgia,serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:georgia,serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;padding:0;margin:0 0 1.45rem}h1{font-size:2.25rem}h1,h2{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{padding:0;margin:0 0 1.45rem}ol,ul{padding:0;margin:0 0 1.45rem 1.45rem;list-style-position:outside;list-style-image:none}dd,dl,figure,p{padding:0;margin:0 0 1.45rem}pre{margin:0 0 1.45rem;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}table{font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset,table{padding:0;margin:0 0 1.45rem}blockquote{padding:0;margin:0 1.45rem 1.45rem}form,iframe,noscript{padding:0;margin:0 0 1.45rem}hr{padding:0;margin:0 0 calc(1.45rem - 1px);background:rgba(0,0,0,.2);border:none;height:1px}address{padding:0;margin:0 0 1.45rem}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}</style><meta name="generator" content="Gatsby 2.15.28"/><title data-react-helmet="true">Spark Architecture | Spark Docs</title><meta data-react-helmet="true" name="description" content="Documentation for Spark FHIR server"/><meta data-react-helmet="true" property="og:title" content="Spark Architecture"/><meta data-react-helmet="true" property="og:description" content="Documentation for Spark FHIR server"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Spark Architecture"/><meta data-react-helmet="true" name="twitter:description" content="Documentation for Spark FHIR server"/><link rel="shortcut icon" href="/spark/icons/icon-48x48.png?v=008654519ce705ac7bc44303a9014606"/><link rel="manifest" href="/spark/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/spark/icons/icon-48x48.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="72x72" href="/spark/icons/icon-72x72.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="96x96" href="/spark/icons/icon-96x96.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="144x144" href="/spark/icons/icon-144x144.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="192x192" href="/spark/icons/icon-192x192.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="256x256" href="/spark/icons/icon-256x256.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="384x384" href="/spark/icons/icon-384x384.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="512x512" href="/spark/icons/icon-512x512.png?v=008654519ce705ac7bc44303a9014606"/><link as="script" rel="preload" href="/spark/component---src-pages-get-started-architecture-md-c86171bbd879611c662a.js"/><link as="script" rel="preload" href="/spark/commons-a1e0186b3d4c834fdc18.js"/><link as="script" rel="preload" href="/spark/app-ae622f60c7095169ca0b.js"/><link as="script" rel="preload" href="/spark/styles-e87ad07d09f962ea6e0e.js"/><link as="script" rel="preload" href="/spark/webpack-runtime-64612ad5d87e4ff810e8.js"/><link as="fetch" rel="preload" href="/spark/page-data/architecture/page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><style data-emotion-css="1v5src1">.css-1v5src1{font-family:'Source Sans Pro',sans-serif;font-size:20px;font-weight:400;line-height:1.5;color:var(--theme-ui-colors-text,#F5F6F7);background-color:var(--theme-ui-colors-background,#1D2330);}</style><div class="css-1v5src1"><style data-emotion-css="jrjj6h">.css-jrjj6h > div{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;}</style><style data-emotion-css="1ubpee3">.css-1ubpee3{min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1ubpee3 > div{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;}</style><style data-emotion-css="hbri28">.css-hbri28{box-sizing:border-box;min-width:0;min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-hbri28 > div{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;}</style><div data-testid="layout" class="css-hbri28"><style data-emotion-css="1xva7m0">body{margin:0;padding:0;}.icon-link{display:none;}.with-overlay{overflow:hidden;}</style><style data-emotion-css="j7qwjs">.css-j7qwjs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><style data-emotion-css="ktct5k">.css-ktct5k{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><style data-emotion-css="pza6pf">.css-pza6pf{box-sizing:border-box;min-width:0;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><main class="css-pza6pf"><style data-emotion-css="1hyy01n">.css-1hyy01n{background-color:var(--theme-ui-colors-header-bg,#13161F);position:relative;z-index:1;border-bottom:1px solid var(--theme-ui-colors-border,#2D3747);}</style><div data-testid="header" class="css-1hyy01n"><style data-emotion-css="zankq9">.css-zankq9{display:none;position:absolute;top:calc(100% + 15px);left:30px;}@media screen and (max-width:57.5em){.css-zankq9{display:block;}}</style><style data-emotion-css="1s0wdqz">.css-1s0wdqz{box-sizing:border-box;min-width:0;display:none;position:absolute;top:calc(100% + 15px);left:30px;}@media screen and (max-width:57.5em){.css-1s0wdqz{display:block;}}</style><div class="css-1s0wdqz"><style data-emotion-css="qxem6n">.css-qxem6n{padding:0;outline:none;background:transparent;border:none;color:var(--theme-ui-colors-header-text,#CED4DE);opacity:0.5;cursor:pointer;}.css-qxem6n:hover{cursor:pointer;}</style><button class="css-qxem6n"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button></div><style data-emotion-css="a1ndby">.css-a1ndby{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding-left:32px;padding-right:32px;padding-top:24px;padding-bottom:24px;position:relative;}</style><div class="css-a1ndby"><style data-emotion-css="xenp3v">.css-xenp3v{-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;font-weight:600;font-size:24px;}</style><style data-emotion-css="1abzlu">.css-1abzlu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;font-weight:600;font-size:24px;}</style><style data-emotion-css="ug0363">.css-ug0363{box-sizing:border-box;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;font-weight:600;font-size:24px;}</style><div data-testid="logo" class="css-ug0363"><style data-emotion-css="1mcfp5n">.css-1mcfp5n{font-weight:600;color:var(--theme-ui-colors-header-text,#CED4DE);-webkit-text-decoration:none;text-decoration:none;}.css-1mcfp5n:hover{color:var(--theme-ui-colors-primary,#1FB6FF);}</style><a class="css-1mcfp5n" href="/spark/">Spark Docs</a></div><style data-emotion-css="k008qs">.css-k008qs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><style data-emotion-css="80zs6q">.css-80zs6q{box-sizing:border-box;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-80zs6q"><style data-emotion-css="12z0wuy">.css-12z0wuy{margin-right:8px;}</style><style data-emotion-css="q6cf68">.css-q6cf68{box-sizing:border-box;min-width:0;margin-right:8px;}</style><div class="css-q6cf68"><style data-emotion-css="1t14cxp">.css-1t14cxp{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:12px;border:none;border-radius:9999px;background-color:var(--theme-ui-colors-header-button-bg,#1FB6FF);color:var(--theme-ui-colors-header-button-color,#FFFFFF);font-size:12px;font-weight:600;cursor:pointer;}</style><a href="https://github.com/firelyTeam/spark" target="_blank" rel="noopener noreferrer" class="css-1t14cxp"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></div><button class="css-1t14cxp"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></button></div><style data-emotion-css="1gncnz1">.css-1gncnz1{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;bottom:-40px;right:30px;background-color:transparent;color:var(--theme-ui-colors-muted,#67788a);font-size:14px;-webkit-text-decoration:none;text-decoration:none;border-radius:4px;}</style><a href="https://github.com/firelyTeam/spark/edit/master/docs/src/pages/Get_started/Architecture.md" target="_blank" rel="noopener noreferrer" class="css-1gncnz1"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg><style data-emotion-css="1iuj5ih">.css-1iuj5ih{padding-left:8px;}</style><style data-emotion-css="1x2jprh">.css-1x2jprh{box-sizing:border-box;min-width:0;padding-left:8px;}</style><div class="css-1x2jprh">Edit page</div></a></div></div><style data-emotion-css="eg2ipj">.css-eg2ipj{padding-top:0;padding-bottom:0;-webkit-flex:1;-ms-flex:1;flex:1;display:grid;grid-template-rows:100%;grid-template-columns:250px 1fr;}@media screen and (max-width:57.5em){.css-eg2ipj{display:block;}}</style><div class="css-eg2ipj"><style data-emotion-css="1pifdlb">.css-1pifdlb{z-index:999;position:fixed;top:88px;right:0;bottom:0;left:0;background:rgba(0,0,0,0.6);-webkit-transition:all .2s ease-out;transition:all .2s ease-out;visibility:hidden;opacity:0;}</style><style data-emotion-css="1uo7pix">.css-1uo7pix{box-sizing:border-box;min-width:0;z-index:999;position:fixed;top:88px;right:0;bottom:0;left:0;background:rgba(0,0,0,0.6);-webkit-transition:all .2s ease-out;transition:all .2s ease-out;visibility:hidden;opacity:0;}</style><div class="css-1uo7pix"></div><style data-emotion-css="1hw90fb">.css-1hw90fb{padding-top:32px;padding-bottom:32px;padding-left:32px;padding-right:32px;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:-webkit-sticky;position:sticky;top:0;z-index:1;min-width:0;max-height:100vh;border-right:1px solid var(--theme-ui-colors-border,#2D3747);overflow:auto;-webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-sidebar-bg,#1D2330);}@media screen and (max-width:57.5em){.css-1hw90fb{z-index:9999;display:block;position:fixed;top:88px;left:0;bottom:0;width:256px;padding-left:32px;padding-right:32px;background-color:var(--theme-ui-colors-background,#1D2330);-webkit-transition:-webkit-transform .2s ease-out;-webkit-transition:transform .2s ease-out;transition:transform .2s ease-out;-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);}}</style><style data-emotion-css="1n1kvaa">.css-1n1kvaa{box-sizing:border-box;min-width:0;padding-top:32px;padding-bottom:32px;padding-left:32px;padding-right:32px;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:-webkit-sticky;position:sticky;top:0;z-index:1;min-width:0;max-height:100vh;border-right:1px solid var(--theme-ui-colors-border,#2D3747);overflow:auto;-webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-sidebar-bg,#1D2330);}@media screen and (max-width:57.5em){.css-1n1kvaa{z-index:9999;display:block;position:fixed;top:88px;left:0;bottom:0;width:256px;padding-left:32px;padding-right:32px;background-color:var(--theme-ui-colors-background,#1D2330);-webkit-transition:-webkit-transform .2s ease-out;-webkit-transition:transform .2s ease-out;transition:transform .2s ease-out;-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);}}</style><div data-testid="sidebar" class="css-1n1kvaa"><style data-emotion-css="111boms">.css-111boms{margin-bottom:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div data-testid="nav-search" class="css-111boms"><style data-emotion-css="19ybfjx">.css-19ybfjx{color:var(--theme-ui-colors-border,#2D3747);margin-right:8px;}</style><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-19ybfjx"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><style data-emotion-css="16x27m2">.css-16x27m2{outline:none;background:none;border:none;color:var(--theme-ui-colors-text,#F5F6F7);font-size:14px;}</style><input placeholder="Type to search..." value="" class="css-16x27m2"/></div><style data-emotion-css="4xo8y6">.css-4xo8y6{margin-top:8px;margin-bottom:8px;display:block;color:var(--theme-ui-colors-sidebar-navGroup,#67788a);-webkit-text-decoration:none;text-decoration:none;font-size:16px;}.css-4xo8y6.active{color:var(--theme-ui-colors-sidebar-navLinkActive,#1FB6FF);}</style><a class="css-4xo8y6" href="/spark/contribute">Contribute to Spark</a><style data-emotion-css="1ebprri">.css-1ebprri{margin-top:16px;margin-bottom:16px;}</style><div data-testid="nav-group" class="css-1ebprri"><style data-emotion-css="xgczw">.css-xgczw{margin-bottom:4px;font-size:16px;font-weight:500;color:var(--theme-ui-colors-sidebar-navGroup,#67788a);cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-xgczw">Deployment<style data-emotion-css="1scp5x8">.css-1scp5x8{margin-left:4px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-align-self:baseline;-ms-flex-item-align:baseline;align-self:baseline;-webkit-transform:rotateX(180deg);-ms-transform:rotateX(180deg);transform:rotateX(180deg);-webkit-transform-origin:center;-ms-transform-origin:center;transform-origin:center;-webkit-transition:-webkit-transform .3s ease-in-out;-webkit-transition:transform .3s ease-in-out;transition:transform .3s ease-in-out;}</style><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-1scp5x8"><polyline points="6 9 12 15 18 9"></polyline></svg></div><style data-emotion-css="1isemmb">.css-1isemmb{margin-left:8px;}</style><div data-testid="nav-group-links" class="css-1isemmb"><a class="css-4xo8y6" href="/spark/using_spark">Fitting Spark in my environment</a><a class="css-4xo8y6" href="/spark/performance">Performance</a><a class="css-4xo8y6" href="/spark/deployment">Spark FHIR server</a></div></div><div data-testid="nav-group" class="css-1ebprri"><div class="css-xgczw">Get started<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-1scp5x8"><polyline points="6 9 12 15 18 9"></polyline></svg></div><div data-testid="nav-group-links" class="css-1isemmb"><a class="css-4xo8y6" href="/spark/install">Installing Spark</a><a class="css-4xo8y6" href="/spark/install/docker">Running Spark in Docker</a><a aria-current="page" class="css-4xo8y6 active" href="/spark/architecture">Spark Architecture</a></div></div><div data-testid="nav-group" class="css-1ebprri"><div class="css-xgczw">Resources<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-1scp5x8"><polyline points="6 9 12 15 18 9"></polyline></svg></div><div data-testid="nav-group-links" class="css-1isemmb"><a class="css-4xo8y6" href="/spark/src-pages-resources-forge">Forge</a><a class="css-4xo8y6" href="/spark/resources/simplifier">Simplifier.net</a></div></div><a class="css-4xo8y6" href="/spark/">Spark FHIR server</a></div><style data-emotion-css="sa3anx">.css-sa3anx{background-color:var(--theme-ui-colors-background,#1D2330);position:relative;max-width:960px;padding-top:48px;padding-bottom:48px;padding-left:32px;padding-right:32px;}@media screen and (max-width:57.5em){.css-sa3anx{padding-top:48px;padding-bottom:32px;padding-left:32px;padding-right:32px;}}</style><style data-emotion-css="pg78uw">.css-pg78uw{width:100%;min-width:0;max-width:1280px;margin-left:auto;margin-right:auto;padding:32px;background-color:var(--theme-ui-colors-background,#1D2330);position:relative;max-width:960px;padding-top:48px;padding-bottom:48px;padding-left:32px;padding-right:32px;}@media screen and (max-width:57.5em){.css-pg78uw{padding-top:48px;padding-bottom:32px;padding-left:32px;padding-right:32px;}}</style><style data-emotion-css="1konvcw">.css-1konvcw{box-sizing:border-box;min-width:0;width:100%;min-width:0;max-width:1280px;margin-left:auto;margin-right:auto;padding:32px;background-color:var(--theme-ui-colors-background,#1D2330);position:relative;max-width:960px;padding-top:48px;padding-bottom:48px;padding-left:32px;padding-right:32px;}@media screen and (max-width:57.5em){.css-1konvcw{padding-top:48px;padding-bottom:32px;padding-left:32px;padding-right:32px;}}</style><div data-testid="main-container" class="css-1konvcw"><style data-emotion-css="1vci3bl">.css-1vci3bl{padding:0;margin:0;margin-bottom:16px;font-size:48px;font-family:'Source Sans Pro',sans-serif;line-height:1.125;font-weight:700;}</style><h1 id="spark-fhir-server" class="css-1vci3bl">Spark FHIR server</h1><style data-emotion-css="1ftn47p">.css-1ftn47p{padding:0;margin:0;margin-bottom:16px;}</style><p class="css-1ftn47p">Spark is built in three layers:</p><style data-emotion-css="cvh4i0">.css-cvh4i0{padding:0;margin:0;margin-bottom:16px;list-style-position:outside;list-style-image:none;margin-left:16px;}</style><ol class="css-cvh4i0"><style data-emotion-css="q43a5f">.css-q43a5f{margin-bottom:4px;padding-left:0;}.css-q43a5f ol{margin-top:8px;margin-bottom:8px;margin-left:16px;}.css-q43a5f ul{margin-top:8px;margin-bottom:8px;margin-left:16px;}.css-q43a5f p{margin-bottom:8px;}</style><li class="css-q43a5f">Spark Server (Spark.Web for Asp.net core 2.1, or Spark.csproj for ASP.net 4.6): An ASP.Net MVC application hosting both a (minimal) visual interface, the FHIR (REST) endpoint and a Maintenance operation.</li><li class="css-q43a5f">Spark Engine (Spark.Engine.csproj): The implementation of everything FHIR: the REST interface, indexing of the search parameters and interpreting search requests, construction of FHIR responses etc.</li><li class="css-q43a5f">Spark Mongo (Spark.Mongo.csproj): Storage and retrieval of both resources and the index based on MongoDB.</li></ol><h1 id="spark-is-built-on-the-net-fhir-api" class="css-1vci3bl">Spark is built on the .NET FHIR API</h1><p class="css-1ftn47p">Spark uses the .NET FHIR API to parse and serialize resources, and as a source of metadata about the FHIR specification: what Resource types are available, what is the definition of the SearchParameters and so on. The parsing and serialization in this API is heavily optimized. Using Spark you get the benefits of that. It also means that Spark is bound to a specific version of the API, which is currently the DSTU2 version.</p><h1 id="spark-engine" class="css-1vci3bl">Spark Engine</h1><p class="css-1ftn47p">Spark Engine provides:</p><ol class="css-cvh4i0"><li class="css-q43a5f">Interfaces for the various functions that must be implemented by the storage layer: <ul class="css-cvh4i0"><li class="css-q43a5f">IFhirStore: Add and retrieve resources.</li><li class="css-q43a5f">IFhirIndex: Process resources to index entries, search resources using the index.</li><li class="css-q43a5f">IIndexStore: Save and delete index entries.</li><li class="css-q43a5f">ISnapShotStore: Save and retrieve snapshots of search results for paging.</li><li class="css-q43a5f">IHistoryStore: Get previous versions of a resource, a resource type or the whole system.</li><li class="css-q43a5f">IGenerator: Generate ID&#x27;s for new resources and new versions of resources.</li></ul></li><li class="css-q43a5f">Services for handling generic FHIR functionality<ul class="css-cvh4i0"><li class="css-q43a5f">SearchService: Combine IFhirIndex and ISnapShotStore to paging results.</li><li class="css-q43a5f">ElementIndexer: Translate FHIR DataTypes to parts of an Index entry.</li><li class="css-q43a5f">ConformanceService: Provide the conformance statement of Spark.</li></ul></li><li class="css-q43a5f">ASP.NET Filters for handling cross cutting FHIR concerns:<ul class="css-cvh4i0"><li class="css-q43a5f">Translating Exceptions to FHIR Response Messages (an http error or OperationOutcome)</li><li class="css-q43a5f">(De)compression of request and response data.</li></ul></li><li class="css-q43a5f">ASP.NET Formatters for several wire formats:<ul class="css-cvh4i0"><li class="css-q43a5f">JSON</li><li class="css-q43a5f">XML</li><li class="css-q43a5f">Binary</li><li class="css-q43a5f">HTML</li></ul></li><li class="css-q43a5f">All kinds of model and helper classes to assist in the functions above.</li></ol><p class="css-1ftn47p">This all accumulates in (I)FhirService, that presents all the FHIR functions.</p><h1 id="spark-mongo" class="css-1vci3bl">Spark Mongo</h1><p class="css-1ftn47p">The MongoDB implementation of Spark stores the resources, the index, the snapshots and the generated ID&#x27;s in MongoDB, with one collection for each. Previous versions of resources are also in the Resources collection. The Index collection contains only the current version of every resource.</p><p class="css-1ftn47p">MongoSearcher implements the actual searching mechanism on the MongoDB index, using the generic ResourceVisitor and Criterium classes in Spark Engine.</p><p class="css-1ftn47p">Be aware that MongoDB is heavily used (especially on searches), so it should be on an endpoint with very little latency.</p></div></div></main></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/architecture";window.webpackCompilationHash="b791f5afd28417c2e208";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-ae622f60c7095169ca0b.js"],"component---src-pages-contribute-md":["/component---src-pages-contribute-md-ee91b4d320d53ea76821.js"],"component---src-pages-deployment-deploy-spark-md":["/component---src-pages-deployment-deploy-spark-md-653efb08ba8955190819.js"],"component---src-pages-deployment-performance-md":["/component---src-pages-deployment-performance-md-1e6cc9f5e4aab3082d23.js"],"component---src-pages-deployment-using-spark-md":["/component---src-pages-deployment-using-spark-md-e89ffe182464dab0762e.js"],"component---src-pages-get-started-architecture-md":["/component---src-pages-get-started-architecture-md-c86171bbd879611c662a.js"],"component---src-pages-get-started-installing-spark-md":["/component---src-pages-get-started-installing-spark-md-adb95b5961ee634167a3.js"],"component---src-pages-get-started-run-with-docker-md":["/component---src-pages-get-started-run-with-docker-md-b6f61c834e5aa099de6d.js"],"component---src-pages-resources-forge-md":["/component---src-pages-resources-forge-md-9aab51d9d718acf2c7bf.js"],"component---src-pages-resources-simplifier-net-md":["/component---src-pages-resources-simplifier-net-md-bbf3b5059e9af8c32e34.js"],"component---src-pages-404-js":["/component---src-pages-404-js-353394379033c92f6eb4.js"],"component---src-pages-index-md":["/component---src-pages-index-md-b71cf348bff2162a8fc1.js"]};/*]]>*/</script><script src="/spark/webpack-runtime-64612ad5d87e4ff810e8.js" async=""></script><script src="/spark/styles-e87ad07d09f962ea6e0e.js" async=""></script><script src="/spark/app-ae622f60c7095169ca0b.js" async=""></script><script src="/spark/commons-a1e0186b3d4c834fdc18.js" async=""></script><script src="/spark/component---src-pages-get-started-architecture-md-c86171bbd879611c662a.js" async=""></script></body></html>